0. cd parent folder containing this script

1. Source kalibr workspace

2. Record 4 bags: 2 front_stereo_camera.bag (front cameras (~ 4Hz) and imu), 2 down_stereo_camera.bag (down cameras and imu). If you use throttled topic it's worth it to check the rostopic field in the calibration output files.

3. Front Camera Calibration with Equidistant Distortion for front cameras
	a.	kalibr_calibrate_cameras --target ./parameter_files/april_6x6.yaml --bag BAG_PATH_CAM_CALIBRATION.bag --models pinhole-equi pinhole-equi --topics /uvc_camera/cam_0/image_raw_throttle /uvc_camera/cam_1/image_raw_throttle
	b.	copy output from current directory to ./out/camcam.yaml
	c. **remove in case the 'throttle' string the the rostopic field**.

4. Front Camera-IMU Calibration.
	a.	update parameter_files/imu_adis16448 with IMU topic and frequency of camera0.
	b.	rosrun kalibr kalibr_calibrate_imu_camera --cam ./out/camcam.yaml  --target ./parameter_files/april_6x6.yaml --imu ./parameter_files/imu_adis16448.yaml --bag BAG_PATH_IMU_CALIBRATION.bag --time-calibration #use time-calibration to check time difference between camera and imu
	c.	copy output to ./out/camchain.yaml
	d.  copy report to ./out/report/camchain.pdf
	e. [optional] if you flipped the cameras, then add "flip_camera: true" after the field "timeshift_cam_imu".

5.	Rovio calibration file for Camera0
	a.	rosrun kalibr kalibr_rovio_config --cam ./out/camchain.yaml
	b.	move rovio_camX to .out/rovio_equidist_camX.yaml 
	c.	move rovio_test to ./out/rovio_filter.yaml
	d.	# in rovio_filter.yaml set doVECalibration to false # leave it to true for now

6. As Step 3, but with down cameras.
	a.	kalibr_calibrate_cameras --target ./parameter_files/april_6x6.yaml --bag BAG_PATH_CAM_CALIBRATION.bag --models pinhole-equi pinhole-equi --topics /uvc_camera/cam_2/image_raw_throttle /uvc_camera/cam_3/image_raw_throttle
	b.	copy output from current directory to ./out/camcam_down.yaml
	c. **remove in case the 'throttle' string the the rostopic field**.

7. Maplab configuration file for FRONT cameras.
	a. rosrun kalibr kalibr_maplab_config --to-ncamera \
    --label front-config \
    --cam ./out/camchain.yaml
    b.	copy output from current directory to ./out/sensor.yaml

9. As Step 4, but with down cameras.
	a. rosrun kalibr kalibr_calibrate_imu_camera --cam ./out/camcam_down.yaml  --target ./parameter_files/april_6x6.yaml --imu ./parameter_files/imu_adis16448.yaml --bag BAG_PATH_IMU_CALIBRATION.bag --time-calibration #use time-calibration to check time difference between camera and imu
	c.	copy output to ./out/down_camchain.yaml
	d.  copy report to ./out/report/down_camchain.pdf
	d. [optional] if you flipped the cameras, then add "flip_camera: true" after the field "timeshift_cam_imu".
	e. **change "cam_overlaps" with appropriate camera number**.

10.	Front Camera0-Robot's Imu calibration
	a.	update parameter_files/imu_xsens_mti_100.yaml with MAV IMU topic and frequency.
	b.	rosrun kalibr kalibr_calibrate_imu_camera --cam ./out/camcam.yaml --target ./parameter_files/april_6x6.yaml --imu ./parameter_files/imu_xsens_mti_100.yaml --bag BAG_PATH_IMU_IMU_CALIBRATION.bag --time-calibration #use time-calibration to check time difference between camera imu and robot's imu - IN CASE OF ERROR ADD '--timeoffset-padding 0.1'
	c.	copy output to ./out/camchain_visensor_robotimu.yaml

11. MSF Vision for Camera0
	a.	rosrun kalibr kalibr_msf_config --viimu ./out/camchain.yaml --mavimu ./out/camchain_visensor_robotimu.yaml --out ./out/msf_parameters_vision.yaml
	b. remember in this file the frames are: I == Robot's IMU; C == Sensor's IMU.
